---

- name: Converge
  hosts: all
  tasks:
    - name: 'Test win_dns_records - add records - overwrite: yes'
      vars:
        win_dns_records:
        - zone: '{{ win_dns_record_zone }}'
          name: test1
          value: 1.2.3.11
          type: A
          overwrite: yes
          state: present
      include_role:
        name: amtega.win_dns_records
        allow_duplicates: yes

    - name: 'Test win_dns_records - add records - overwrite: no'
      vars:
        win_dns_records:
        - zone: '{{ win_dns_record_zone }}'
          name: test2
          value: 1.2.3.12
          type: A
          overwrite: no
          state: present
      include_role:
        name: amtega.win_dns_records
        allow_duplicates: yes

    - name: 'Test win_dns_records - add records - overwrite: default'
      vars:
        win_dns_records:
        - zone: '{{ win_dns_record_zone }}'
          name: test3
          value: 1.2.3.13
          type: A
          state: present
        - zone: '{{ win_dns_record_revzone }}'
          name: 13
          value: "test3.{{ win_dns_record_zone }}"
          type: PTR
          overwrite: yes
      include_role:
        name: amtega.win_dns_records
        allow_duplicates: yes

    - name: 'Test win_dns_records - add records - overwrite: no'
      vars:
        win_dns_records:
        - zone: '{{ win_dns_record_zone }}'
          name: test4
          type: A
          state: absent
      include_role:
        name: amtega.win_dns_records
        allow_duplicates: yes
